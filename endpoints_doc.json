[
    {
        "endpoint": "GET /api/leads/count",
        "description": "Obtiene el conteo total de leads (conversaciones únicas) en los últimos 7 días.",
        "input": {},
        "output": {
            "success": true,
            "data": {
                "count": 142
            },
            "message": "Conteo obtenido correctamente"
        },
        "sql_logic": "SELECT COUNT(distinct remitente_wa_id) as total FROM bbdd_sophia..conversaciones where fecha_mensaje >= CONVERT(date, GETDATE() - 7)"
    },
    {
        "endpoint": "GET /api/leads/contacted",
        "description": "Obtiene el número de conversiones iniciadas en los últimos 7 días.",
        "input": {},
        "output": {
            "success": true,
            "data": {
                "count": 85
            },
            "message": "Leads contactados obtenidos"
        },
        "sql_logic": "SELECT COUNT(*) FROM bbdd_sophia..conversaciones WHERE fecha_mensaje >= CONVERT(date, GETDATE() - 7)"
    },
    {
        "endpoint": "GET /api/leads/conversions",
        "description": "Obtiene el número de citas agendadas en los últimos 7 días.",
        "input": {},
        "output": {
            "success": true,
            "data": {
                "count": 12
            },
            "message": "Conversiones obtenidas"
        },
        "sql_logic": "SELECT COUNT(*) FROM bbdd_sophia..tb_citas WHERE fecha_mensaje >= CONVERT(date, GETDATE() - 7)"
    },
    {
        "endpoint": "GET /api/leads/avg-time",
        "description": "Calcula el tiempo promedio de respuesta en minutos.",
        "input": {},
        "output": {
            "success": true,
            "data": {
                "value": "15m"
            },
            "message": "Tiempo promedio calculado"
        },
        "sql_logic": "Calculated via LAG() window function on conversations table."
    },
    {
        "endpoint": "GET /api/leads/weekly",
        "description": "Obtiene la cantidad de leads agrupados por día de la semana (últimos 7 días).",
        "input": {},
        "output": {
            "success": true,
            "data": [
                {
                    "name": "Mon",
                    "leads": 20
                },
                {
                    "name": "Tue",
                    "leads": 35
                }
            ],
            "message": "Datos semanales obtenidos"
        },
        "sql_logic": "GROUP BY DATENAME(WEEKDAY, fecha_mensaje)"
    },
    {
        "endpoint": "GET /api/leads/recent",
        "description": "Obtiene los mensajes más recientes.",
        "input": {},
        "output": {
            "success": true,
            "data": [
                {
                    "message": "Hola, info?",
                    "time": "10:30"
                }
            ],
            "message": "Actividad reciente obtenida"
        },
        "sql_logic": "SELECT TOP N ... ORDER BY fecha_mensaje DESC"
    },
    {
        "endpoint": "POST /api/login",
        "description": "Autentica a un usuario.",
        "input": {
            "id": "E029863",
            "password": "password123"
        },
        "output": {
            "success": true,
            "data": {
                "user": {
                    "id": "E029863",
                    "name": "Admin",
                    "role": "admin",
                    "permission_level": 8,
                    "client_id": null
                }
            },
            "message": "Login exitoso"
        },
        "sql_logic": "SELECT * FROM users_main WHERE id = @id"
    },
    {
        "endpoint": "GET /api/users",
        "description": "Obtiene lista de usuarios. Filtra por cliente si no es super admin.",
        "input": {
            "client_id": "1 (opcional)",
            "permission_level": "8 (opcional)"
        },
        "output": {
            "success": true,
            "data": [
                {
                    "id": "E123",
                    "name": "Juan",
                    "role": "user"
                }
            ],
            "message": "Usuarios obtenidos"
        },
        "sql_logic": "SELECT * FROM users_main [WHERE client_id = @id]"
    },
    {
        "endpoint": "POST /api/vacantes",
        "description": "Crea una nueva vacante y sus condiciones generales.",
        "input": {
            "nombre": "Developer",
            "client_id": 1,
            "sueldo": 50000,
            "bono": 5000,
            "horarios": "9-6",
            "beneficios": "Gym",
            "requisitos": "React",
            "documentacion": "INE"
        },
        "output": {
            "success": true,
            "data": {
                "vacanteId": 105
            },
            "message": "Vacante creada exitosamente"
        },
        "sql_logic": "INSERT INTO Vacantes... INSERT INTO CondicionesGenerales..."
    }
]